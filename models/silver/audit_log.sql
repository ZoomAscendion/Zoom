{{
  config(
    materialized='table',
    on_schema_change='sync_all_columns'
  )
}}

SELECT
    '{{ invocation_id }}' AS EXECUTION_ID,
    'bronze_to_silver_transformation' AS PIPELINE_NAME,
    CURRENT_TIMESTAMP() AS START_TIME,
    CURRENT_TIMESTAMP() AS END_TIME,
    'RUNNING' AS STATUS,
    NULL AS ERROR_MESSAGE,
    0 AS EXECUTION_DURATION_SECONDS,
    'BZ_USERS,BZ_MEETINGS,BZ_PARTICIPANTS,BZ_FEATURE_USAGE,BZ_SUPPORT_TICKETS,BZ_BILLING_EVENTS,BZ_LICENSES,BZ_WEBINARS' AS SOURCE_TABLES_PROCESSED,
    'SI_USERS,SI_MEETINGS,SI_PARTICIPANTS,SI_FEATURE_USAGE,SI_SUPPORT_TICKETS,SI_BILLING_EVENTS,SI_LICENSES,SI_WEBINARS' AS TARGET_TABLES_UPDATED,
    0 AS RECORDS_PROCESSED,
    0 AS RECORDS_INSERTED,
    0 AS RECORDS_UPDATED,
    0 AS RECORDS_REJECTED,
    'DBT_SYSTEM' AS EXECUTED_BY,
    'DEVELOPMENT' AS EXECUTION_ENVIRONMENT,
    'Bronze to Silver Layer Transformation Pipeline' AS DATA_LINEAGE_INFO,
    CURRENT_DATE() AS LOAD_DATE,
    CURRENT_DATE() AS UPDATE_DATE,
    'DBT_PIPELINE' AS SOURCE_SYSTEM
