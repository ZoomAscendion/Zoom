version: 2

sources:
  - name: bronze
    description: "Bronze layer tables containing raw data from source systems"
    tables:
      - name: bz_users
        description: "Bronze users table with raw user data"
        columns:
          - name: user_name
            description: "User display name"
          - name: email
            description: "User email address"
          - name: company
            description: "User company name"
          - name: plan_type
            description: "User subscription plan type"
          - name: load_timestamp
            description: "Timestamp when record was loaded"
          - name: update_timestamp
            description: "Timestamp when record was last updated"
          - name: source_system
            description: "Source system identifier"
            
      - name: bz_meetings
        description: "Bronze meetings table with raw meeting data"
        columns:
          - name: host_id
            description: "Meeting host user identifier"
          - name: meeting_topic
            description: "Meeting topic or title"
          - name: start_time
            description: "Meeting start timestamp"
          - name: end_time
            description: "Meeting end timestamp"
          - name: duration_minutes
            description: "Meeting duration in minutes"
          - name: load_timestamp
            description: "Timestamp when record was loaded"
          - name: update_timestamp
            description: "Timestamp when record was last updated"
          - name: source_system
            description: "Source system identifier"
            
      - name: bz_participants
        description: "Bronze participants table with raw participant data"
        columns:
          - name: meeting_id
            description: "Meeting identifier"
          - name: user_id
            description: "Participant user identifier"
          - name: join_time
            description: "Participant join timestamp"
          - name: leave_time
            description: "Participant leave timestamp"
          - name: load_timestamp
            description: "Timestamp when record was loaded"
          - name: update_timestamp
            description: "Timestamp when record was last updated"
          - name: source_system
            description: "Source system identifier"
            
      - name: bz_billing_events
        description: "Bronze billing events table with raw billing data"
        columns:
          - name: user_id
            description: "User identifier for billing event"
          - name: event_type
            description: "Type of billing event"
          - name: amount
            description: "Billing amount"
          - name: event_date
            description: "Date of billing event"
          - name: load_timestamp
            description: "Timestamp when record was loaded"
          - name: update_timestamp
            description: "Timestamp when record was last updated"
          - name: source_system
            description: "Source system identifier"

models:
  - name: audit_log
    description: "Silver layer audit log for tracking pipeline executions"
    columns:
      - name: audit_id
        description: "Unique identifier for audit record"
        tests:
          - unique
          - not_null
      - name: pipeline_name
        description: "Name of the pipeline being executed"
        tests:
          - not_null
      - name: execution_status
        description: "Status of pipeline execution"
        tests:
          - accepted_values:
              values: ['INITIALIZED', 'STARTED', 'RUNNING', 'COMPLETED', 'FAILED']
              
  - name: si_users
    description: "Silver layer users table with cleansed and standardized user data"
    columns:
      - name: user_id
        description: "Unique identifier for user"
        tests:
          - unique
          - not_null
      - name: user_name
        description: "User display name"
        tests:
          - not_null
      - name: email
        description: "User email address (validated and standardized)"
        tests:
          - not_null
          - unique
      - name: plan_type
        description: "User subscription plan type"
        tests:
          - accepted_values:
              values: ['Free', 'Basic', 'Pro', 'Enterprise']
      - name: data_quality_score
        description: "Data quality score (0.00-1.00)"
        tests:
          - not_null
              
  - name: si_meetings
    description: "Silver layer meetings table with validated meeting data and derived attributes"
    columns:
      - name: meeting_id
        description: "Unique identifier for meeting"
        tests:
          - unique
          - not_null
      - name: host_id
        description: "Meeting host user identifier"
        tests:
          - not_null
      - name: duration_minutes
        description: "Meeting duration in minutes"
      - name: data_quality_score
        description: "Data quality score (0.00-1.00)"
        tests:
          - not_null
              
  - name: si_participants
    description: "Silver layer participants table with attendance metrics and engagement scores"
    columns:
      - name: participant_id
        description: "Unique identifier for participant record"
        tests:
          - unique
          - not_null
      - name: meeting_id
        description: "Meeting identifier"
        tests:
          - not_null
      - name: user_id
        description: "Participant user identifier"
        tests:
          - not_null
      - name: engagement_score
        description: "Engagement score (0.00-1.00)"
              
  - name: si_billing_events
    description: "Silver layer billing events table with validated and standardized billing data"
    columns:
      - name: billing_event_id
        description: "Unique identifier for billing event"
        tests:
          - unique
          - not_null
      - name: user_id
        description: "User identifier for billing event"
        tests:
          - not_null
      - name: event_type
        description: "Standardized billing event type"
        tests:
          - accepted_values:
              values: ['Payment', 'Refund', 'Subscription', 'Upgrade', 'Downgrade']
      - name: amount
        description: "Billing amount (validated)"
        tests:
          - not_null
      - name: currency_code
        description: "Currency code (ISO standard)"
        tests:
          - not_null
          - accepted_values:
              values: ['USD']
