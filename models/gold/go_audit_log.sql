{{ config(
    materialized='table'
) }}

-- Audit log table for tracking all Gold layer transformations
SELECT 
    'AUDIT_LOG_INIT_' || TO_CHAR(CURRENT_TIMESTAMP(), 'YYYYMMDDHH24MISS') AS PROCESS_ID,
    'AUDIT_LOG_INITIALIZATION' AS PROCESS_NAME,
    'SYSTEM' AS SOURCE_TABLE,
    'GO_AUDIT_LOG' AS TARGET_TABLE,
    CURRENT_TIMESTAMP() AS PROCESS_START_TIME,
    CURRENT_TIMESTAMP() AS PROCESS_END_TIME,
    'COMPLETED' AS PROCESS_STATUS,
    1 AS RECORDS_PROCESSED,
    1 AS RECORDS_SUCCESS,
    0 AS RECORDS_FAILED,
    CURRENT_TIMESTAMP() AS CREATED_AT,
    CURRENT_TIMESTAMP() AS UPDATED_AT
