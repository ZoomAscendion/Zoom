{{ config(
    materialized='table'
) }}

-- Audit log table for Gold layer process tracking
-- This table must be created first before any other models

SELECT 
    'INIT_001' AS PROCESS_ID,
    'GOLD_LAYER_INITIALIZATION' AS PROCESS_NAME,
    'AUDIT_LOG_CREATION' AS PROCESS_TYPE,
    CURRENT_TIMESTAMP() AS PROCESS_START_TIMESTAMP,
    CURRENT_TIMESTAMP() AS PROCESS_END_TIMESTAMP,
    0 AS PROCESS_DURATION_SECONDS,
    'SUCCESS' AS PROCESS_STATUS,
    'SYSTEM' AS SOURCE_TABLE,
    'GO_AUDIT_LOG' AS TARGET_TABLE,
    1 AS RECORDS_PROCESSED,
    1 AS RECORDS_SUCCESS,
    0 AS RECORDS_FAILED,
    100.0 AS DATA_QUALITY_SCORE,
    0 AS ERROR_COUNT,
    0 AS WARNING_COUNT,
    'SYSTEM_INITIALIZATION' AS PROCESS_TRIGGER,
    'DBT_SYSTEM' AS EXECUTED_BY,
    CURRENT_DATE() AS LOAD_DATE,
    CURRENT_DATE() AS UPDATE_DATE,
    'DBT_GOLD_LAYER' AS SOURCE_SYSTEM
