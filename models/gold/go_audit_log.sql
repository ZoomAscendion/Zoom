{{ config(
    materialized='table',
    tags=['audit', 'gold']
) }}

-- Audit log table for Gold layer pipeline execution tracking
SELECT 
    CAST(UUID_STRING() AS VARCHAR(255)) AS PROCESS_ID,
    CAST('GOLD_PIPELINE_INIT' AS VARCHAR(255)) AS PROCESS_NAME,
    CAST('INITIALIZATION' AS VARCHAR(100)) AS PROCESS_TYPE,
    CURRENT_TIMESTAMP() AS PROCESS_START_TIME,
    CURRENT_TIMESTAMP() AS PROCESS_END_TIME,
    CAST(0 AS NUMBER(10,2)) AS PROCESS_DURATION_SECONDS,
    CAST('SUCCESS' AS VARCHAR(50)) AS PROCESS_STATUS,
    CAST('SYSTEM' AS VARCHAR(255)) AS SOURCE_TABLE,
    CAST('GO_AUDIT_LOG' AS VARCHAR(255)) AS TARGET_TABLE,
    CAST(1 AS NUMBER(20,0)) AS RECORDS_PROCESSED,
    CAST(1 AS NUMBER(20,0)) AS RECORDS_SUCCESS,
    CAST(0 AS NUMBER(20,0)) AS RECORDS_FAILED,
    CAST(100.0 AS NUMBER(5,2)) AS DATA_QUALITY_SCORE,
    CAST(0 AS NUMBER(15,0)) AS ERROR_COUNT,
    CAST(0 AS NUMBER(15,0)) AS WARNING_COUNT,
    CAST('SYSTEM_INITIALIZATION' AS VARCHAR(100)) AS PROCESS_TRIGGER,
    CAST('DBT_SYSTEM' AS VARCHAR(100)) AS EXECUTED_BY,
    CAST('DBT_CLOUD' AS VARCHAR(100)) AS SERVER_NAME,
    CAST('1.0' AS VARCHAR(50)) AS PROCESS_VERSION,
    PARSE_JSON('{}') AS CONFIGURATION_PARAMETERS,
    PARSE_JSON('{}') AS PERFORMANCE_METRICS,
    CURRENT_DATE() AS LOAD_DATE,
    CURRENT_DATE() AS UPDATE_DATE,
    CAST('DBT_GOLD_PIPELINE' AS VARCHAR(100)) AS SOURCE_SYSTEM
