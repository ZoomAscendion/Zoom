{{ config(
    materialized='table',
    pre_hook="",
    post_hook=""
) }}

-- Gold Layer Process Audit Log
-- This table must be created first and run before any other models

SELECT
    ROW_NUMBER() OVER (ORDER BY CURRENT_TIMESTAMP()) AS AUDIT_ID,
    CAST('INITIAL_SETUP' AS VARCHAR(255)) AS PROCESS_NAME,
    CAST('GO_AUDIT_LOG' AS VARCHAR(255)) AS SOURCE_TABLE,
    CAST('GO_AUDIT_LOG' AS VARCHAR(255)) AS TARGET_TABLE,
    CURRENT_TIMESTAMP() AS PROCESS_START_TIME,
    CURRENT_TIMESTAMP() AS PROCESS_END_TIME,
    CAST('SUCCESS' AS VARCHAR(50)) AS PROCESS_STATUS,
    CAST(1 AS NUMBER(10,0)) AS RECORDS_PROCESSED,
    CAST(1 AS NUMBER(10,0)) AS RECORDS_SUCCESS,
    CAST(0 AS NUMBER(10,0)) AS RECORDS_FAILED,
    CAST('Initial audit log setup' AS VARCHAR(500)) AS PROCESS_NOTES,
    CURRENT_DATE() AS LOAD_DATE,
    CURRENT_DATE() AS UPDATE_DATE,
    CAST('DBT_GOLD_PIPELINE' AS VARCHAR(100)) AS SOURCE_SYSTEM
